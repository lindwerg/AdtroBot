---
phase: 16-testing-and-polish
plan: 05
type: execute
wave: 3
depends_on: ["16-02", "16-03", "16-04"]
files_modified:
  - admin-frontend/src/pages/Dashboard.tsx
  - admin-frontend/src/pages/Users.tsx
  - admin-frontend/src/pages/Messages.tsx
  - admin-frontend/src/pages/Monitoring.tsx
  - admin-frontend/src/components/Layout.tsx
  - .planning/BUGS.md
autonomous: false

must_haves:
  truths:
    - "Error messages понятны пользователю"
    - "Loading states показываются при загрузке"
    - "Empty states информативны"
    - "Навигация интуитивна"
  artifacts:
    - path: "admin-frontend/src/pages/Dashboard.tsx"
      provides: "Polished dashboard"
      contains: "Spin"
    - path: ".planning/BUGS.md"
      provides: "Complete bug list"
      contains: "Category"
  key_links:
    - from: "admin-frontend/src/pages/*.tsx"
      to: "antd components"
      via: "UX patterns"
      pattern: "Spin|Empty|Alert"
---

<objective>
UX Polish админки на основе findings из тестов: error messages, loading states, empty states, navigation improvements.

Purpose: Максимальное качество UX согласно CONTEXT.md (ADMIN-01, ADMIN-02, ADMIN-03). Polish на основе реальных findings.
Output: Улучшенный UX админки, финальный BUGS.md
</objective>

<execution_context>
@/Users/kirill/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kirill/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/16-testing-and-polish/16-CONTEXT.md
@.planning/phases/16-testing-and-polish/16-02-SUMMARY.md
@.planning/phases/16-testing-and-polish/16-03-SUMMARY.md
@.planning/phases/16-testing-and-polish/16-04-SUMMARY.md
@.planning/BUGS.md
@admin-frontend/src/pages/Dashboard.tsx
@admin-frontend/src/pages/Users.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Loading States и Spinners</name>
  <files>
    admin-frontend/src/pages/Dashboard.tsx
    admin-frontend/src/pages/Users.tsx
    admin-frontend/src/pages/Monitoring.tsx
  </files>
  <action>
    1. Проверить и улучшить Dashboard.tsx:
       - Добавить Spin wrapper при isLoading
       - Skeleton для карточек метрик при загрузке
       - Плавная анимация появления данных

    2. Проверить и улучшить Users.tsx:
       - Table loading state (Antd Table имеет встроенный)
       - Skeleton rows при первой загрузке
       - Disable кнопок при загрузке

    3. Проверить и улучшить Monitoring.tsx:
       - Spin для графиков при загрузке
       - Placeholder для пустых графиков
       - Loading indicator при смене фильтров

    Использовать Antd компоненты:
    - `<Spin spinning={isLoading}>`
    - `<Skeleton active />`
    - `<Table loading={isLoading} />`

    **Критерий:** Пользователь всегда видит feedback что данные загружаются.
  </action>
  <verify>
    ```bash
    cd admin-frontend && npm run build
    ```
    Билд проходит без ошибок.
  </verify>
  <done>
    - Loading states добавлены на Dashboard
    - Loading states добавлены на Users
    - Loading states добавлены на Monitoring
    - Используются Antd Spin/Skeleton
  </done>
</task>

<task type="auto">
  <name>Task 2: Empty States и Error Messages</name>
  <files>
    admin-frontend/src/pages/Messages.tsx
    admin-frontend/src/pages/Users.tsx
    admin-frontend/src/pages/Monitoring.tsx
  </files>
  <action>
    1. Добавить Empty states:
       - Messages: "Нет отправленных сообщений" с иконкой
       - Users: "Пользователи не найдены" при пустом поиске
       - Monitoring: "Нет данных за выбранный период"

       Использовать Antd Empty:
       ```tsx
       <Empty
         image={Empty.PRESENTED_IMAGE_SIMPLE}
         description="Нет данных"
       >
         <Button type="primary">Действие</Button>
       </Empty>
       ```

    2. Улучшить Error messages:
       - Показывать понятные сообщения вместо технических
       - Использовать Alert компонент для ошибок
       - Добавить "Повторить" кнопку при ошибках

       ```tsx
       {error && (
         <Alert
           message="Ошибка загрузки"
           description={getHumanReadableError(error)}
           type="error"
           showIcon
           action={<Button onClick={refetch}>Повторить</Button>}
         />
       )}
       ```

    3. Проверить validation feedback:
       - Form validation messages на русском
       - Мгновенный feedback при вводе
       - Highlight ошибочных полей
  </action>
  <verify>
    ```bash
    cd admin-frontend && npm run build
    ```
    Билд проходит.
  </verify>
  <done>
    - Empty states на всех страницах с данными
    - Error messages понятные и локализованные
    - Validation feedback мгновенный
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    UX improvements в админке:
    - Loading states (spinners, skeletons)
    - Empty states с полезными подсказками
    - Error messages с понятными сообщениями
    - Улучшенная навигация
  </what-built>
  <how-to-verify>
    1. Запустить админку: `cd admin-frontend && npm run dev`
    2. Открыть http://localhost:5173/admin/login
    3. Войти с credentials

    **Проверить:**
    - Dashboard: видны loading states при обновлении?
    - Users: пустой поиск показывает "Не найдено"?
    - Monitoring: пустой период показывает empty state?
    - Ошибки: понятные сообщения на русском?

    4. Проверить navigation:
    - Переходы между страницами плавные?
    - Active state в меню виден?
    - Breadcrumbs понятны?

    5. Задокументировать оставшиеся issues в BUGS.md
  </how-to-verify>
  <resume-signal>Напишите "approved" или опишите проблемы для исправления</resume-signal>
</task>

<task type="auto">
  <name>Task 4: Финализация BUGS.md</name>
  <files>
    .planning/BUGS.md
  </files>
  <action>
    1. Собрать все баги из тестов:
       - Из Playwright тестов (16-02)
       - Из Telethon тестов (16-03)
       - Из Load тестов (16-04)
       - Из human verification

    2. Приоритизировать:
       - P0: Критические (блокируют использование)
       - P1: Важные (ухудшают UX значительно)
       - P2: Minor (косметические)

    3. Финальный формат BUGS.md:
       ```markdown
       # BUGS.md - Phase 16 Bug Tracking

       ## Summary
       - Total bugs: X
       - P0 (Critical): Y
       - P1 (Important): Z
       - P2 (Minor): W

       ## Bugs

       | ID | Category | Severity | Status | Component | Description | Steps to Reproduce |
       |----|----------|----------|--------|-----------|-------------|-------------------|
       | B001 | Admin | P1 | Open | Dashboard | ... | 1. ... 2. ... |
       | B002 | Bot | P2 | Open | Horoscope | ... | 1. ... 2. ... |

       ---
       *Generated: 2026-01-24*
       *Phase: 16-testing-and-polish*
       ```

    4. Убедиться что каждый баг имеет:
       - Уникальный ID
       - Category (Admin/Bot/Backend/Frontend)
       - Severity (P0/P1/P2)
       - Component
       - Описание
       - Steps to Reproduce

    **ВАЖНО:** Баги НЕ исправляются в этой фазе. Только документируются.
  </action>
  <verify>
    ```bash
    cat .planning/BUGS.md | head -20
    ```
    Показывает отформатированную таблицу багов.
  </verify>
  <done>
    - BUGS.md содержит все найденные баги
    - Баги приоритизированы (P0/P1/P2)
    - Каждый баг имеет steps to reproduce
    - Summary секция с подсчетом
  </done>
</task>

</tasks>

<verification>
1. `cd admin-frontend && npm run build` — билд успешен
2. Loading states видны при обновлении страниц
3. Empty states показываются при пустых данных
4. Error messages понятные
5. BUGS.md содержит полный список багов
</verification>

<success_criteria>
- [ ] Loading states на Dashboard, Users, Monitoring
- [ ] Empty states на всех страницах с данными
- [ ] Error messages локализованы и понятны
- [ ] Human verification пройдена
- [ ] BUGS.md финализирован со всеми багами
- [ ] Все баги приоритизированы
</success_criteria>

<output>
После завершения создать `.planning/phases/16-testing-and-polish/16-05-SUMMARY.md`
</output>
