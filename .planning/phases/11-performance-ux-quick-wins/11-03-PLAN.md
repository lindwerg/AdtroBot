---
phase: 11-performance-ux-quick-wins
plan: 03
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - src/bot/handlers/horoscope.py
  - src/bot/keyboards/horoscope.py
  - src/bot/handlers/start.py
  - src/bot/handlers/tarot.py
  - src/bot/handlers/natal.py
  - src/bot/handlers/common.py
autonomous: true

must_haves:
  truths:
    - "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –û–±—â–∏–º –∏ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–º –≥–æ—Ä–æ—Å–∫–æ–ø–æ–º –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö"
    - "–ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Ç–≤–µ—Ç–∞ —á–µ—Ç–∫–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∏–ø –≥–æ—Ä–æ—Å–∫–æ–ø–∞"
    - "–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ –≥–æ—Ä–æ—Å–∫–æ–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü—ã"
    - "–ü–æ—Å–ª–µ –≤–≤–æ–¥–∞ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ä–∞–∑—É –≤–∏–¥–∏—Ç —Å–≤–æ–π –≥–æ—Ä–æ—Å–∫–æ–ø"
    - "Premium teaser –ø–æ–Ω—è—Ç–Ω–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥–ø–∏—Å–∫–∏"
    - "Markdown —Ä–∞–∑–º–µ—Ç–∫–∞ –Ω–µ –≤–∏–¥–Ω–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö (–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π parse_mode)"
  artifacts:
    - path: "src/bot/handlers/horoscope.py"
      provides: "–†–∞–∑–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è —Ç–∏–ø–æ–≤ –≥–æ—Ä–æ—Å–∫–æ–ø–∞ + parse_mode"
      contains: "–û–±—â–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø –¥–ª—è"
    - path: "src/bot/handlers/start.py"
      provides: "–ü–æ–∫–∞–∑ –≥–æ—Ä–æ—Å–∫–æ–ø–∞ –ø–æ—Å–ª–µ onboarding"
      contains: "show_horoscope_message"
    - path: "src/bot/handlers/tarot.py"
      provides: "parse_mode –¥–ª—è Markdown"
      contains: "ParseMode.MARKDOWN"
    - path: "src/bot/handlers/natal.py"
      provides: "parse_mode –¥–ª—è Markdown"
      contains: "ParseMode.MARKDOWN"
  key_links:
    - from: "src/bot/handlers/start.py"
      to: "src/bot/handlers/horoscope.py"
      via: "import show_horoscope_message"
      pattern: "from src.bot.handlers.horoscope import show_horoscope_message"
    - from: "src/bot/handlers/start.py"
      to: "src/bot/utils/progress.py"
      via: "uses generate_with_feedback from 11-01"
      pattern: "generate_with_feedback"
---

<objective>
–£–ª—É—á—à–∏—Ç—å UX –≥–æ—Ä–æ—Å–∫–æ–ø–æ–≤: –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ–±—â–∏–π/–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π, –ø–æ–Ω—è—Ç–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞ free->premium, —É–ª—É—á—à–µ–Ω–Ω—ã–π first forecast. –ò—Å–ø—Ä–∞–≤–∏—Ç—å Markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ –≤—Å–µ—Ö handlers.

Purpose: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–Ω–∏–º–∞–µ—Ç —Ü–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –≥–æ—Ä–æ—Å–∫–æ–ø–∞ –∏ –≤–∏–¥–∏—Ç —á–µ—Ç–∫–∏–π –ø—É—Ç—å –∫ premium. Markdown —Ä–∞–∑–º–µ—Ç–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–Ω–µ –∫–∞–∫ —Ç–µ–∫—Å—Ç).

Output: –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å —Ç–∏–ø–∞–º–∏ –≥–æ—Ä–æ—Å–∫–æ–ø–∞, —É–ª—É—á—à–µ–Ω–Ω—ã–π onboarding flow, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π parse_mode –≤–æ –≤—Å–µ—Ö handlers.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-performance-ux-quick-wins/11-CONTEXT.md
@.planning/phases/11-performance-ux-quick-wins/11-RESEARCH.md
@.planning/phases/11-performance-ux-quick-wins/11-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≥–æ—Ä–æ—Å–∫–æ–ø–æ–≤</name>
  <files>src/bot/handlers/horoscope.py</files>
  <action>
–û–±–Ω–æ–≤–∏—Ç—å `src/bot/handlers/horoscope.py` –¥–ª—è —á–µ—Ç–∫–æ–≥–æ —Ä–∞–∑–ª–∏—á–∏—è —Ç–∏–ø–æ–≤ –≥–æ—Ä–æ—Å–∫–æ–ø–∞.

**–í —Ñ—É–Ω–∫—Ü–∏–∏ `show_zodiac_horoscope`:**

1. –î–ª—è premium —Å natal data (–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π):
```python
header = f"{zodiac.emoji} –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø –¥–ª—è {zodiac.name_ru}"
```

2. –î–ª—è premium –±–µ–∑ natal data –∏–ª–∏ free user (–æ–±—â–∏–π):
```python
header = f"{zodiac.emoji} –û–±—â–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø –¥–ª—è {zodiac.name_ru}"
```

**–í —Ñ—É–Ω–∫—Ü–∏–∏ `show_horoscope_message`:**

–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
1. –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π: `f"{zodiac.emoji} –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø –¥–ª—è {zodiac.name_ru}"`
2. –û–±—â–∏–π: `f"{zodiac.emoji} –û–±—â–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø –¥–ª—è {zodiac.name_ru}"`

**–û–±–Ω–æ–≤–∏—Ç—å PREMIUM_TEASER:**

–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ç–µ–∫—Å—Ç –Ω–∞ –±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π:

```python
PREMIUM_TEASER = """
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚≠ê –•–û–ß–ï–®–¨ –ü–ï–†–°–û–ù–ê–õ–¨–ù–´–ô –ü–†–û–ì–ù–û–ó?

–≠—Ç–æ –±—ã–ª –æ–±—â–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø –¥–ª—è —Ç–≤–æ–µ–≥–æ –∑–Ω–∞–∫–∞.
–° –ø–æ–¥–ø–∏—Å–∫–æ–π —Ç—ã –ø–æ–ª—É—á–∏—à—å:

üîÆ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø –ø–æ —Ç–≤–æ–µ–π –Ω–∞—Ç–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç–µ
‚ù§Ô∏è –ü—Ä–æ–≥–Ω–æ–∑ –ø–æ —Å—Ñ–µ—Ä–∞–º: –ª—é–±–æ–≤—å, –∫–∞—Ä—å–µ—Ä–∞, —Ñ–∏–Ω–∞–Ω—Å—ã
üé¥ 20 —Ä–∞—Å–∫–ª–∞–¥–æ–≤ —Ç–∞—Ä–æ –≤ –¥–µ–Ω—å
‚≠ê –ö–µ–ª—å—Ç—Å–∫–∏–π –∫—Ä–µ—Å—Ç (10 –∫–∞—Ä—Ç)

–í—Å–µ–≥–æ 299 ‚ÇΩ/–º–µ—Å ‚Äî –ø–æ–ø—Ä–æ–±—É–π!
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"""
```
  </action>
  <verify>
- Grep –¥–ª—è "–û–±—â–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø": `grep -n "–û–±—â–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø" src/bot/handlers/horoscope.py`
- Grep –¥–ª—è "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø": `grep -n "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø" src/bot/handlers/horoscope.py`
- Grep –¥–ª—è –Ω–æ–≤–æ–≥–æ teaser: `grep -n "–•–û–ß–ï–®–¨ –ü–ï–†–°–û–ù–ê–õ–¨–ù–´–ô" src/bot/handlers/horoscope.py`
- –°–∏–Ω—Ç–∞–∫—Å–∏—Å: `python -c "from src.bot.handlers.horoscope import router"`
  </verify>
  <done>
- –ó–∞–≥–æ–ª–æ–≤–∫–∏ —á–µ—Ç–∫–æ —Ä–∞–∑–ª–∏—á–∞—é—Ç "–û–±—â–∏–π" –∏ "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π"
- PREMIUM_TEASER –æ–±—ä—è—Å–Ω—è–µ—Ç —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —Ç–∏–ø–∞–º–∏
- Handler –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
  </done>
</task>

<task type="auto">
  <name>Task 2: –£–ª—É—á—à–∏—Ç—å –ø–µ—Ä–≤—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ—Å–ª–µ onboarding</name>
  <files>src/bot/handlers/start.py</files>
  <action>
–û–±–Ω–æ–≤–∏—Ç—å `src/bot/handlers/start.py` ‚Äî –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø –≤–º–µ—Å—Ç–æ mock.

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç 11-01:** –≠—Ç–æ—Ç task –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `generate_with_feedback` –∏–∑ `src/bot/utils/progress.py`, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –≤ –ø–ª–∞–Ω–µ 11-01. –£–±–µ–¥–∏—Å—å —á—Ç–æ 11-01 –≤—ã–ø–æ–ª–Ω–µ–Ω –∏ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞.

**–í —Ñ—É–Ω–∫—Ü–∏–∏ `process_birthdate`:**

1. –£–¥–∞–ª–∏—Ç—å –≤—ã–∑–æ–≤ `get_mock_horoscope(zodiac.name)` –∏ `await message.answer(horoscope)`

2. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `show_horoscope_message`:
```python
from src.bot.handlers.horoscope import show_horoscope_message
```

3. –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è zodiac –ø–æ–∫–∞–∑–∞—Ç—å –≥–æ—Ä–æ—Å–∫–æ–ø:
```python
# Show zodiac
await message.answer(f"‚ú® –¢–≤–æ–π –∑–Ω–∞–∫: {zodiac.emoji} {zodiac.name_ru}")

# Show real horoscope with explanation
await message.answer(
    "–í–æ—Ç —Ç–≤–æ–π –ø–µ—Ä–≤—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø!\n\n"
    "üí° –°–µ–π—á–∞—Å —Ç—ã –≤–∏–¥–∏—à—å –æ–±—â–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø –¥–ª—è –≤—Å–µ—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π —Ç–≤–æ–µ–≥–æ –∑–Ω–∞–∫–∞.\n"
    "–° Premium –ø–æ–¥–ø–∏—Å–∫–æ–π —Ç—ã –ø–æ–ª—É—á–∏—à—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑, "
    "—Å–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ —Ç–≤–æ–µ–π –Ω–∞—Ç–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç–µ."
)

# Show actual horoscope
await show_horoscope_message(message, zodiac.name, zodiac.name, session)
```

4. –£–¥–∞–ª–∏—Ç—å import `get_mock_horoscope` –µ—Å–ª–∏ –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–í–ê–ñ–ù–û:**
- `show_horoscope_message` —É–∂–µ –≤–∫–ª—é—á–∞–µ—Ç premium teaser –¥–ª—è free users
- –ü–æ—Å–ª–µ –≥–æ—Ä–æ—Å–∫–æ–ø–∞ –≤—Å–µ –µ—â–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å notification prompt
- –£–±—Ä–∞—Ç—å —Å—Ç–∞—Ä—ã–π "–•–æ—á–µ—à—å –∫–∞—Ä—Ç—É –¥–Ω—è? –ù–∞–∂–º–∏ '–¢–∞—Ä–æ'" ‚Äî –≥–æ—Ä–æ—Å–∫–æ–ø —É–∂–µ –ø–æ–∫–∞–∑–∞–Ω —Å –º–µ–Ω—é
  </action>
  <verify>
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç 11-01: `python -c "from src.bot.utils.progress import generate_with_feedback; print('11-01 dependency OK')"`
- Grep –¥–ª—è show_horoscope_message import: `grep -n "from src.bot.handlers.horoscope import" src/bot/handlers/start.py`
- Grep –¥–ª—è mock —É–¥–∞–ª–µ–Ω: `grep -n "get_mock_horoscope" src/bot/handlers/start.py` (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ –∏–ª–∏ —Ç–æ–ª—å–∫–æ import –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–¥–µ-—Ç–æ)
- Grep –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è: `grep -n "–æ–±—â–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø" src/bot/handlers/start.py`
- –°–∏–Ω—Ç–∞–∫—Å–∏—Å: `python -c "from src.bot.handlers.start import router"`
  </verify>
  <done>
- –ü–æ—Å–ª–µ onboarding –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø, –Ω–µ mock
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü—ã –æ–±—â–∏–π/–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π
- –°—Ç–∞—Ä—ã–π mock horoscope —É–¥–∞–ª–µ–Ω –∏–∑ flow
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç 11-01 (generate_with_feedback) –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
  </done>
</task>

<task type="auto">
  <name>Task 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å UX –¥–ª—è premium –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</name>
  <files>src/bot/keyboards/horoscope.py, src/bot/handlers/horoscope.py</files>
  <action>
**–†–µ—à–µ–Ω–∏–µ –ø–æ –∫–Ω–æ–ø–∫–∞–º –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞:**

Premium –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø (–µ—Å–ª–∏ –µ—Å—Ç—å natal data). –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º ‚Äî —ç—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç UX –±–µ–∑ –ø–æ–ª—å–∑—ã.

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ src/bot/handlers/horoscope.py:**

1. –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –≥–æ—Ä–æ—Å–∫–æ–ø–∞ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
   - Premium + natal data = –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π
   - Premium –±–µ–∑ natal data = –æ–±—â–∏–π
   - Free user = –æ–±—â–∏–π

2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–∏–∑ Task 1) –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç —Ç–∏–ø

**–í src/bot/keyboards/horoscope.py:**

–ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –¢–µ–∫—É—â–∏–µ –∫–Ω–æ–ø–∫–∏ —Å–æ –∑–Ω–∞–∫–∞–º–∏ –∑–æ–¥–∏–∞–∫–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
  </action>
  <verify>
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç (–æ—Ç Task 1): `grep -E "(–û–±—â–∏–π|–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π) –≥–æ—Ä–æ—Å–∫–æ–ø" src/bot/handlers/horoscope.py`
- –°–∏–Ω—Ç–∞–∫—Å–∏—Å keyboards: `python -c "from src.bot.keyboards.horoscope import build_zodiac_keyboard"`
  </verify>
  <done>
- –ó–∞–≥–æ–ª–æ–≤–∫–∏ —á–µ—Ç–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç "–û–±—â–∏–π" vs "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π" (–∏–∑ Task 1)
- Premium –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø
- UX –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º (–±–µ–∑ –ª–∏—à–Ω–∏—Ö –∫–ª–∏–∫–æ–≤)
  </done>
</task>

<task type="auto">
  <name>Task 4: –ò—Å–ø—Ä–∞–≤–∏—Ç—å Markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (UX-02)</name>
  <files>src/bot/handlers/horoscope.py, src/bot/handlers/tarot.py, src/bot/handlers/natal.py, src/bot/handlers/common.py, src/bot/handlers/start.py</files>
  <action>
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –¥–æ–±–∞–≤–∏—Ç—å `parse_mode` –≤–æ –≤—Å–µ –≤—ã–∑–æ–≤—ã `message.answer()` –∏ `callback.message.edit_text()` –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ UX-02:** "Markdown —Ä–∞–∑–º–µ—Ç–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∏–¥–Ω–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö" ‚Äî –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç `*bold*`, `_italic_`, –∏–ª–∏ —Å–ø–∏—Å–∫–∏ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω parse_mode.

**–®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å import –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö –≥–¥–µ –Ω—É–∂–µ–Ω parse_mode:**
```python
from aiogram.enums import ParseMode
```

**–®–∞–≥ 2: –í src/bot/handlers/horoscope.py:**

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –≤—ã–∑–æ–≤—ã `answer()` –∏ `edit_text()`:
- –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç Markdown —Ä–∞–∑–º–µ—Ç–∫—É (bold, italic, —Å–ø–∏—Å–∫–∏) ‚Äî –¥–æ–±–∞–≤–∏—Ç—å `parse_mode=ParseMode.MARKDOWN`
- –î–ª—è AI-generated —Ç–µ–∫—Å—Ç–∞ (–≥–æ—Ä–æ—Å–∫–æ–ø—ã): AI –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å Markdown, –ø–æ—ç—Ç–æ–º—É –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û parse_mode

–ü—Ä–∏–º–µ—Ä:
```python
await callback.message.edit_text(
    text,
    reply_markup=keyboard,
    parse_mode=ParseMode.MARKDOWN,
)
```

**–®–∞–≥ 3: –í src/bot/handlers/tarot.py:**

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å parse_mode –¥–ª—è:
- Interpretation —Ç–µ–∫—Å—Ç–æ–≤ (AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å Markdown)
- Card descriptions –µ—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–®–∞–≥ 4: –í src/bot/handlers/natal.py:**

–î–æ–±–∞–≤–∏—Ç—å parse_mode –¥–ª—è:
- Natal interpretation (AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å Markdown)
- –õ—é–±—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**–®–∞–≥ 5: –í src/bot/handlers/common.py:**

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å HELP_TEXT –∏ ABOUT_TEXT:
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Markdown (—á—Ç–æ –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ —Å—É–¥—è –ø–æ —Ç–µ–∫—Å—Ç–∞–º) ‚Äî –¥–æ–±–∞–≤–∏—Ç—å parse_mode
- –ï—Å–ª–∏ plain text —Å —ç–º–æ–¥–∑–∏ ‚Äî parse_mode –Ω–µ –Ω—É–∂–µ–Ω

**–®–∞–≥ 6: –í src/bot/handlers/start.py:**

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å WELCOME_MESSAGE –∏ –¥—Ä—É–≥–∏–µ —Ç–µ–∫—Å—Ç—ã:
- –¢–µ–∫—É—â–∏–π WELCOME_MESSAGE –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —ç–º–æ–¥–∑–∏ (–Ω–µ Markdown) ‚Äî parse_mode –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
- –ù–æ –µ—Å–ª–∏ –¥–æ–±–∞–≤—è—Ç—Å—è bold/italic ‚Äî –Ω—É–∂–µ–Ω parse_mode

**–í–ê–ñ–ù–û:**
- –ù–ï –¥–æ–±–∞–≤–ª—è—Ç—å parse_mode –∫ –ø—Ä–æ—Å—Ç–æ–º—É —Ç–µ–∫—Å—Ç—É –±–µ–∑ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–ª–∏—à–Ω–∏–π overhead)
- ParseMode.MARKDOWN –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤ —Å `*bold*`, `_italic_`
- ParseMode.HTML –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤ —Å `<b>bold</b>`, `<i>italic</i>` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- –î–ª—è AI-generated –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è—Ç—å parse_mode (AI –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å Markdown)
  </action>
  <verify>
- Grep –¥–ª—è ParseMode import: `grep -rn "from aiogram.enums import ParseMode" src/bot/handlers/`
- Grep –¥–ª—è parse_mode usage: `grep -rn "parse_mode=" src/bot/handlers/`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ AI-generated —Ç–µ–∫—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç parse_mode:
  - Horoscope: `grep -A2 "edit_text\|\.answer" src/bot/handlers/horoscope.py | grep -E "text=|parse_mode"`
  - Tarot: `grep -A2 "edit_text\|\.answer" src/bot/handlers/tarot.py | grep -E "interpretation|parse_mode"`
  - Natal: `grep -A2 "edit_text\|\.answer" src/bot/handlers/natal.py | grep -E "interpretation|parse_mode"`
- –°–∏–Ω—Ç–∞–∫—Å–∏—Å: `python -c "from src.bot.handlers.horoscope import router; from src.bot.handlers.tarot import router; from src.bot.handlers.natal import router"`
  </verify>
  <done>
- ParseMode –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤–æ –≤—Å–µ—Ö handlers –≥–¥–µ –Ω—É–∂–µ–Ω
- AI-generated —Ç–µ–∫—Å—Ç—ã (–≥–æ—Ä–æ—Å–∫–æ–ø—ã, —Ç–∞—Ä–æ, –Ω–∞—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞) –∏—Å–ø–æ–ª—å–∑—É—é—Ç parse_mode=ParseMode.MARKDOWN
- Markdown —Ä–∞–∑–º–µ—Ç–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è (–Ω–µ –∫–∞–∫ plain text)
- –í—Å–µ handlers –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
  </done>
</task>

</tasks>

<verification>
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ horoscope.py:
```bash
grep -E "(–û–±—â–∏–π|–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π) –≥–æ—Ä–æ—Å–∫–æ–ø" src/bot/handlers/horoscope.py
```

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–π teaser:
```bash
grep -A5 "PREMIUM_TEASER" src/bot/handlers/horoscope.py
```

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å first forecast –≤ start.py:
```bash
grep -n "show_horoscope_message" src/bot/handlers/start.py
```

4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü—ã:
```bash
grep -n "–æ–±—â–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø\|–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π" src/bot/handlers/start.py
```

5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å parse_mode (UX-02):
```bash
grep -rn "parse_mode=ParseMode" src/bot/handlers/horoscope.py src/bot/handlers/tarot.py src/bot/handlers/natal.py
```

6. –°–∏–Ω—Ç–∞–∫—Å–∏—Å –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤:
```bash
python -c "
from src.bot.handlers.horoscope import router
from src.bot.handlers.start import router
from src.bot.handlers.tarot import router
from src.bot.handlers.natal import router
from src.bot.keyboards.horoscope import build_zodiac_keyboard
print('All imports OK')
"
```
</verification>

<success_criteria>
- [ ] –ó–∞–≥–æ–ª–æ–≤–∫–∏ –≥–æ—Ä–æ—Å–∫–æ–ø–æ–≤ —Ä–∞–∑–ª–∏—á–∞—é—Ç "–û–±—â–∏–π" –∏ "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π"
- [ ] PREMIUM_TEASER –æ–±—ä—è—Å–Ω—è–µ—Ç —Ä–∞–∑–Ω–∏—Ü—É –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥–ø–∏—Å–∫–∏
- [ ] –ü–æ—Å–ª–µ onboarding –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø (–Ω–µ mock)
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –æ–±—â–∏–π/–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ
- [ ] ParseMode –¥–æ–±–∞–≤–ª–µ–Ω –¥–ª—è AI-generated —Ç–µ–∫—Å—Ç–æ–≤ (–≥–æ—Ä–æ—Å–∫–æ–ø—ã, —Ç–∞—Ä–æ, –Ω–∞—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞)
- [ ] Markdown —Ä–∞–∑–º–µ—Ç–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (UX-02 –≤—ã–ø–æ–ª–Ω–µ–Ω)
- [ ] –í—Å–µ handlers –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
</success_criteria>

<output>
–ü–æ—Å–ª–µ completion —Å–æ–∑–¥–∞—Ç—å `.planning/phases/11-performance-ux-quick-wins/11-03-SUMMARY.md`
</output>
